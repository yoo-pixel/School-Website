<!doctype html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>{{ school_name }}</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/normalize/8.0.1/normalize.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css">
    <link rel="stylesheet" href="{{ url_for('static', filename='styles.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='auth.css') }}">
</head>

<body>
    <canvas id="spaceCanvas"></canvas>
    <canvas id="fallingStarsCanvas"></canvas>
    <div class="scroll-lines" id="scrollLines"></div>

    <header class="header" id="mainHeader">
        <div class="header__container">
            <div class="header__brand">{{ school_name }}</div>
            <nav class="header__nav" id="nav">
                <a href="{{ url_for('index') }}" class="header__link" data-i18n="navHome">Home</a>
                <a href="{{ url_for('programs') }}" class="header__link" data-i18n="navPrograms">Programs</a>
                <a href="{{ url_for('highlights_page') }}" class="header__link" data-i18n="navHighlights">Highlights</a>
                <a href="{{ url_for('admissions') }}" class="header__link" data-i18n="navAdmissions">Admissions</a>
                <a href="{{ url_for('writing_basics') }}" class="header__link" data-i18n="navWriting">Writing Guide</a>
                <a href="{{ url_for('contact') }}" class="header__link" data-i18n="navContact">Contact</a>
            </nav>
            <div class="header__controls">
                {% if session.get('user_id') %}
                <a href="{{ url_for('dashboard') }}" class="header__control-btn header__control-btn--user" title="My Dashboard">
                    <span class="user-icon">üë§</span>
                </a>
                {% else %}
                <a href="{{ url_for('login') }}" class="header__control-btn header__control-btn--login" title="Log In">
                    <span class="login-text">Log In</span>
                </a>
                {% endif %}
                <button class="header__control-btn" id="themeToggle" aria-label="Toggle theme" title="Toggle Dark/Light Mode">
                    <span class="theme-icon theme-icon--sun">‚òÄÔ∏è</span>
                    <span class="theme-icon theme-icon--moon">üåô</span>
                </button>
                <button class="header__control-btn" id="langToggle" aria-label="Toggle language" title="Toggle English/Arabic">
                    <span class="lang-text">EN</span>
                </button>
            </div>
            <button class="header__toggle" id="navToggle" aria-label="Toggle navigation">
                <span></span>
                <span></span>
                <span></span>
            </button>
        </div>
    </header>

    <main class="main-content">
        {% with messages = get_flashed_messages(with_categories=true) %} {% if messages %}
        <div class="flash-list">
            {% for category, message in messages %}
            <div class="flash flash--{{ category }}">{{ message }}</div>
            {% endfor %}
        </div>
        {% endif %} {% endwith %} {% block content %}{% endblock %}
    </main>

    <!-- STEM Guide Assistant -->
    <div class="ai-assistant" id="aiAssistant" aria-label="STEM guide assistant" aria-live="polite">
        <button class="assistant-toggle" id="assistantToggle" aria-expanded="false" aria-controls="assistantPanel">
            <div class="robot">
                <div class="robot__halo"></div>
                <div class="robot__body">
                    <div class="robot__eye robot__eye--left"></div>
                    <div class="robot__eye robot__eye--right"></div>
                    <div class="robot__mouth"></div>
                </div>
                <div class="robot__antenna"></div>
            </div>
            <span class="assistant-label">Need help?</span>
        </button>

        <div class="assistant-panel" id="assistantPanel" role="dialog" aria-modal="false" aria-label="STEM assistant chat">
            <div class="assistant-panel__header">
                <div>
                    <div class="assistant-name">STEM Guide</div>
                    <div class="assistant-sub">Guidance only ‚Ä¢ No official decisions</div>
                </div>
                <div class="assistant-status">
                    <span class="status-dot"></span>
                    <span>Online</span>
                </div>
                <button class="assistant-close" id="assistantClose" aria-label="Close assistant">√ó</button>
            </div>

            <div class="assistant-panel__body">
                <div class="assistant-message assistant-message--bot">Hi! I‚Äôm your STEM guide. I can help you find pages, explain programs, and point you to writing resources. Admissions decisions stay with the Ministry.</div>
                <div class="assistant-quick" id="assistantQuick">
                    <button class="quick-chip" data-question="Help me find programs">Help me find programs</button>
                    <button class="quick-chip" data-question="What scholarships should I look for?">What scholarships should I look for?</button>
                    <button class="quick-chip" data-question="How can I improve my English writing?">How can I improve my English writing?</button>
                    <button class="quick-chip" data-question="Explain admissions simply">Explain admissions simply</button>
                    <button class="quick-chip" data-question="What should I check next on this website?">What should I check next on this website?</button>
                </div>
                <div class="assistant-conversation" id="assistantConversation" aria-live="polite"></div>
            </div>

            <div class="assistant-panel__footer">
                <div class="assistant-disclaimer">Guidance only. Admissions and eligibility are handled by official government systems.</div>
                <div class="assistant-input">
                    <input type="text" id="assistantInput" placeholder="Ask me about programs, writing, or admissions..." aria-label="Assistant question">
                    <button id="assistantSend">Send</button>
                </div>
            </div>
        </div>
    </div>

    <footer class="footer" id="mainFooter">
        <div class="footer__content">
            <div class="footer__text">{{ school_name }} ‚Ä¢ Learning by building.</div>
            <div class="footer__small">¬© {{ current_year or '2026' }} {{ school_name }}</div>
        </div>
    </footer>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <script src="{{ url_for('static', filename='app.js') }}"></script>
</body>

</html>