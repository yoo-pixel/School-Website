{% extends "base.html" %} {% block title %}Browse Programs | {{ school_name }}{% endblock %} {% block content %}
<div class="programs-hero">
    <div style="max-width: 1200px; margin: 0 auto; padding: 48px 28px;">
        <p class="eyebrow--space">OPPORTUNITIES</p>
        <h1 class="h1--space">Global STEM Programs</h1>
        <p class="p--space">40+ curated programs from world-leading institutions and organizations.</p>
    </div>
</div>

<div class="programs-container">
    <!-- LEFT SIDEBAR: FILTERS -->
    <aside class="programs-sidebar">
        <div class="filter-group">
            <h3 class="filter-title">üîç Search</h3>
            <input type="text" id="searchInput" class="filter-search" placeholder="Search by name, keyword...">
        </div>

        <div class="filter-group">
            <h3 class="filter-title">Program Level</h3>
            <label class="filter-checkbox">
                <input type="checkbox" name="level" value="Top-Tier">
                <span class="checkbox-custom"></span>
                <span>Top-Tier</span>
            </label>
            <label class="filter-checkbox">
                <input type="checkbox" name="level" value="Achievable">
                <span class="checkbox-custom"></span>
                <span>Achievable</span>
            </label>
            <label class="filter-checkbox">
                <input type="checkbox" name="level" value="Accessible">
                <span class="checkbox-custom"></span>
                <span>Accessible</span>
            </label>
        </div>

        <div class="filter-group">
            <h3 class="filter-title">Program Type</h3>
            <label class="filter-checkbox">
                <input type="checkbox" name="type" value="Research">
                <span class="checkbox-custom"></span>
                <span>Research</span>
            </label>
            <label class="filter-checkbox">
                <input type="checkbox" name="type" value="Summer School">
                <span class="checkbox-custom"></span>
                <span>Summer School</span>
            </label>
            <label class="filter-checkbox">
                <input type="checkbox" name="type" value="Exchange">
                <span class="checkbox-custom"></span>
                <span>Exchange</span>
            </label>
            <label class="filter-checkbox">
                <input type="checkbox" name="type" value="Innovation / Entrepreneurship">
                <span class="checkbox-custom"></span>
                <span>Innovation & Entrepreneurship</span>
            </label>
            <label class="filter-checkbox">
                <input type="checkbox" name="type" value="Online / Hybrid">
                <span class="checkbox-custom"></span>
                <span>Online / Hybrid</span>
            </label>
            <label class="filter-checkbox">
                <input type="checkbox" name="type" value="Competition">
                <span class="checkbox-custom"></span>
                <span>Competition</span>
            </label>
        </div>

        <div class="filter-group">
            <h3 class="filter-title">Cost</h3>
            <label class="filter-checkbox">
                <input type="checkbox" name="cost" value="Free">
                <span class="checkbox-custom"></span>
                <span>Free</span>
            </label>
            <label class="filter-checkbox">
                <input type="checkbox" name="cost" value="Paid">
                <span class="checkbox-custom"></span>
                <span>Paid</span>
            </label>
            <label class="filter-checkbox">
                <input type="checkbox" name="cost" value="Paid (Financial Aid Available)">
                <span class="checkbox-custom"></span>
                <span>Paid (Financial Aid)</span>
            </label>
        </div>

        <div class="filter-group">
            <h3 class="filter-title">Duration</h3>
            <label class="filter-checkbox">
                <input type="checkbox" name="duration" value="Short (1‚Äì4 weeks)">
                <span class="checkbox-custom"></span>
                <span>Short (1‚Äì4 weeks)</span>
            </label>
            <label class="filter-checkbox">
                <input type="checkbox" name="duration" value="Medium (1‚Äì3 months)">
                <span class="checkbox-custom"></span>
                <span>Medium (1‚Äì3 months)</span>
            </label>
            <label class="filter-checkbox">
                <input type="checkbox" name="duration" value="Long (Semester / Year)">
                <span class="checkbox-custom"></span>
                <span>Long (Semester / Year)</span>
            </label>
        </div>

        <div class="filter-group">
            <h3 class="filter-title">Location</h3>
            <label class="filter-checkbox">
                <input type="checkbox" name="location" value="On-campus">
                <span class="checkbox-custom"></span>
                <span>On-Campus</span>
            </label>
            <label class="filter-checkbox">
                <input type="checkbox" name="location" value="International">
                <span class="checkbox-custom"></span>
                <span>International</span>
            </label>
            <label class="filter-checkbox">
                <input type="checkbox" name="location" value="Online">
                <span class="checkbox-custom"></span>
                <span>Online</span>
            </label>
        </div>

        <div class="filter-group">
            <h3 class="filter-title">Grade Level</h3>
            <label class="filter-checkbox">
                <input type="checkbox" name="grades" value="9">
                <span class="checkbox-custom"></span>
                <span>Grade 9</span>
            </label>
            <label class="filter-checkbox">
                <input type="checkbox" name="grades" value="10">
                <span class="checkbox-custom"></span>
                <span>Grade 10</span>
            </label>
            <label class="filter-checkbox">
                <input type="checkbox" name="grades" value="11">
                <span class="checkbox-custom"></span>
                <span>Grade 11</span>
            </label>
            <label class="filter-checkbox">
                <input type="checkbox" name="grades" value="12">
                <span class="checkbox-custom"></span>
                <span>Grade 12</span>
            </label>
        </div>

        <button id="clearFilters" class="button button--space-ghost" style="width: 100%; margin-top: 24px;">Clear Filters</button>
    </aside>

    <!-- RIGHT SIDE: PROGRAM CARDS -->
    <main class="programs-main">
        <div id="programsGrid" class="programs-grid">
            <!-- Programs will be loaded here via JavaScript -->
        </div>
        <div id="noResults" class="no-results" style="display: none;">
            <p>No programs found matching your filters. Try adjusting your criteria.</p>
        </div>
    </main>
</div>

<style>
    .programs-hero {
        background: linear-gradient(135deg, #000a14 0%, #0a1f38 50%, #051428 100%);
        padding: 64px 28px;
        position: relative;
    }
    
    .programs-hero::after {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: radial-gradient(circle at 30% 40%, rgba(0, 10, 20, 0.7) 0%, transparent 60%);
        z-index: 1;
        pointer-events: none;
    }
    
    .programs-hero * {
        position: relative;
        z-index: 2;
    }
    
    .programs-container {
        display: grid;
        grid-template-columns: 280px 1fr;
        gap: 32px;
        max-width: 1400px;
        margin: 0 auto;
        padding: 48px 28px;
    }
    
    .programs-sidebar {
        position: sticky;
        top: 100px;
        height: fit-content;
        background: rgba(15, 23, 42, 0.8);
        backdrop-filter: blur(20px);
        border: 1px solid rgba(0, 229, 255, 0.2);
        border-radius: 16px;
        padding: 24px;
        box-shadow: 0 8px 32px rgba(0, 0, 0, 0.4);
    }
    
    .filter-group {
        margin-bottom: 28px;
    }
    
    .filter-group:last-child {
        margin-bottom: 0;
    }
    
    .filter-title {
        color: #FFFFFF;
        font-size: 14px;
        font-weight: 700;
        text-transform: uppercase;
        letter-spacing: 0.08em;
        margin: 0 0 12px 0;
        font-family: 'Poppins', sans-serif;
    }
    
    .filter-search {
        width: 100%;
        padding: 10px 12px;
        border-radius: 8px;
        border: 1px solid rgba(0, 229, 255, 0.3);
        background: rgba(15, 23, 42, 0.6);
        color: #FFFFFF;
        font-size: 14px;
        transition: all 0.3s ease;
    }
    
    .filter-search:focus {
        outline: none;
        border-color: rgba(0, 229, 255, 0.6);
        background: rgba(15, 23, 42, 0.8);
    }
    
    .filter-checkbox {
        display: flex;
        align-items: center;
        gap: 10px;
        padding: 8px 0;
        cursor: pointer;
        color: #E5E7EB;
        font-size: 14px;
        transition: color 0.2s ease;
    }
    
    .filter-checkbox:hover {
        color: #FFFFFF;
    }
    
    .filter-checkbox input {
        display: none;
    }
    
    .checkbox-custom {
        display: inline-flex;
        width: 18px;
        height: 18px;
        border: 1px solid rgba(0, 229, 255, 0.4);
        border-radius: 4px;
        background: rgba(0, 229, 255, 0.05);
        transition: all 0.2s ease;
        flex-shrink: 0;
    }
    
    .filter-checkbox input:checked+.checkbox-custom {
        background: rgba(0, 229, 255, 0.3);
        border-color: rgba(0, 229, 255, 0.8);
        box-shadow: inset 0 0 0 2px var(--cyan-electric);
    }
    
    .programs-main {
        flex: 1;
    }
    
    .programs-grid {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
        gap: 24px;
    }
    
    .program-card {
        background: rgba(15, 23, 42, 0.85);
        border: 1px solid rgba(0, 229, 255, 0.25);
        border-radius: 16px;
        padding: 24px;
        backdrop-filter: blur(20px);
        box-shadow: 0 8px 32px rgba(0, 0, 0, 0.4);
        transition: all 0.3s ease;
        display: flex;
        flex-direction: column;
    }
    
    .program-card:hover {
        background: rgba(15, 23, 42, 0.92);
        border-color: rgba(0, 229, 255, 0.4);
        box-shadow: 0 12px 48px rgba(0, 229, 255, 0.15);
        transform: translateY(-4px);
    }
    
    .program-name {
        color: #FFFFFF;
        font-size: 18px;
        font-weight: 800;
        margin: 0 0 6px 0;
        font-family: 'Poppins', sans-serif;
    }
    
    .program-org {
        color: #CBD5E1;
        font-size: 13px;
        font-weight: 500;
        margin: 0 0 12px 0;
    }
    
    .program-desc {
        color: #E5E7EB;
        font-size: 14px;
        line-height: 1.6;
        margin: 0 0 16px 0;
        flex-grow: 1;
    }
    
    .program-badges {
        display: flex;
        flex-wrap: wrap;
        gap: 8px;
        margin: 0 0 16px 0;
    }
    
    .badge {
        display: inline-block;
        padding: 4px 10px;
        border-radius: 4px;
        font-size: 11px;
        font-weight: 600;
        text-transform: uppercase;
        letter-spacing: 0.05em;
    }
    
    .badge--level {
        background: rgba(0, 229, 255, 0.2);
        color: var(--cyan-electric);
        border: 1px solid rgba(0, 229, 255, 0.3);
    }
    
    .badge--type {
        background: rgba(124, 124, 255, 0.15);
        color: #7C7CFF;
        border: 1px solid rgba(124, 124, 255, 0.3);
    }
    
    .program-info {
        display: flex;
        flex-direction: column;
        gap: 10px;
        margin: 16px 0;
        padding: 12px 0;
        border-top: 1px solid rgba(0, 229, 255, 0.1);
        border-bottom: 1px solid rgba(0, 229, 255, 0.1);
        font-size: 13px;
        color: #CBD5E1;
    }
    
    .info-row {
        display: flex;
        align-items: center;
        gap: 8px;
    }
    
    .program-window {
        color: var(--cyan-electric);
        font-size: 12px;
        font-weight: 600;
        margin: 12px 0;
        text-transform: uppercase;
        letter-spacing: 0.05em;
    }
    
    .program-actions {
        display: flex;
        gap: 10px;
        margin-top: 16px;
    }
    
    .btn-detail {
        flex: 1;
        padding: 10px;
        border-radius: 8px;
        background: linear-gradient(135deg, var(--cyan-electric), var(--cyan-bright));
        color: #FFFFFF;
        border: none;
        font-weight: 600;
        font-size: 13px;
        cursor: pointer;
        text-align: center;
        text-decoration: none;
        transition: all 0.2s ease;
    }
    
    .btn-detail:hover {
        transform: translateY(-2px);
        box-shadow: 0 4px 12px rgba(0, 229, 255, 0.3);
    }
    
    .btn-website {
        flex: 1;
        padding: 10px;
        border-radius: 8px;
        background: transparent;
        color: var(--cyan-electric);
        border: 1px solid rgba(0, 229, 255, 0.4);
        font-weight: 600;
        font-size: 13px;
        cursor: pointer;
        text-align: center;
        text-decoration: none;
        transition: all 0.2s ease;
    }
    
    .btn-website:hover {
        background: rgba(0, 229, 255, 0.1);
        border-color: rgba(0, 229, 255, 0.8);
    }
    
    .no-results {
        text-align: center;
        padding: 60px 28px;
        color: #CBD5E1;
        font-size: 18px;
    }
    
    @media (max-width: 1024px) {
        .programs-container {
            grid-template-columns: 1fr;
        }
        .programs-sidebar {
            position: static;
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            padding: 32px;
        }
        .filter-group {
            margin-bottom: 0;
        }
        .programs-grid {
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
        }
    }
    
    @media (max-width: 640px) {
        .programs-container {
            padding: 24px 16px;
        }
        .programs-sidebar {
            grid-template-columns: 1fr;
            padding: 20px;
        }
        .programs-grid {
            grid-template-columns: 1fr;
        }
        .program-actions {
            flex-direction: column;
        }
    }
</style>

<script>
    const allPrograms = {{ programs | tojson }};

    function renderPrograms(programs) {
        const grid = document.getElementById('programsGrid');
        const noResults = document.getElementById('noResults');

        if (programs.length === 0) {
            grid.innerHTML = '';
            noResults.style.display = 'block';
            return;
        }

        noResults.style.display = 'none';
        grid.innerHTML = programs.map(p => `
        <div class="program-card">
            <h3 class="program-name">${p.name}</h3>
            <p class="program-org">${p.organization}</p>
            <p class="program-desc">${p.description}</p>
            
            <div class="program-badges">
                <span class="badge badge--level">${p.level}</span>
                <span class="badge badge--type">${p.type}</span>
            </div>
            
            <div class="program-info">
                <div class="info-row">‚è± <strong>${p.duration}</strong></div>
                <div class="info-row">üí∞ <strong>${p.cost}</strong></div>
                <div class="info-row">üåç <strong>${p.location}</strong></div>
            </div>
            
            <div class="program-window">üìÖ ${p.application_window}</div>
            
            <div class="program-actions">
                <a href="/programs/${p.id}" class="btn-detail">View Details</a>
                <a href="${p.website}" target="_blank" class="btn-website">Website ‚Üó</a>
            </div>
        </div>
    `).join('');
    }

    function getActiveFilters() {
        const filters = {
            level: [],
            type: [],
            cost: [],
            duration: [],
            location: [],
            grades: [],
            search: document.getElementById('searchInput').value.toLowerCase()
        };

        document.querySelectorAll('.filter-checkbox input:checked').forEach(input => {
            filters[input.name].push(input.value);
        });

        return filters;
    }

    function applyFilters() {
        const filters = getActiveFilters();

        let filtered = allPrograms.filter(p => {
            if (filters.level.length && !filters.level.includes(p.level)) return false;
            if (filters.type.length && !filters.type.includes(p.type)) return false;
            if (filters.cost.length && !filters.cost.includes(p.cost)) return false;
            if (filters.duration.length && !filters.duration.includes(p.duration)) return false;
            if (filters.location.length && !filters.location.includes(p.location)) return false;
            if (filters.grades.length && !filters.grades.some(g => p.grades.includes(g))) return false;
            if (filters.search) {
                const searchStr = filters.search;
                if (!p.name.toLowerCase().includes(searchStr) &&
                    !p.description.toLowerCase().includes(searchStr) &&
                    !p.organization.toLowerCase().includes(searchStr)) {
                    return false;
                }
            }
            return true;
        });

        renderPrograms(filtered);
    }

    // Event listeners
    document.querySelectorAll('.filter-checkbox input').forEach(input => {
        input.addEventListener('change', applyFilters);
    });

    document.getElementById('searchInput').addEventListener('input', applyFilters);

    document.getElementById('clearFilters').addEventListener('click', () => {
        document.querySelectorAll('.filter-checkbox input:checked').forEach(input => {
            input.checked = false;
        });
        document.getElementById('searchInput').value = '';
        renderPrograms(allPrograms);
    });

    // Initial render
    renderPrograms(allPrograms);
</script>

{% endblock %}